<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINHMODLAG V90 | ƒê·∫æ CH·∫æ ACC & KEY</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --main: #00ff88; --dark: #0f172a; --card: #1e293b; --text: #f8fafc; --accent: #38bdf8; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Lexend', sans-serif; }
        body { background: var(--dark); color: var(--text); overflow-x: hidden; }

        /* TH√îNG B√ÅO TO√ÄN H·ªÜ TH·ªêNG */
        #globalNotify { display:none; position:fixed; top:20px; right:20px; background:var(--main); color:#000; padding:15px 25px; border-radius:15px; z-index:10000; font-weight:bold; box-shadow:0 10px 30px rgba(0,255,136,0.4); animation: slideIn 0.5s forwards; border: 2px solid white; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        /* M√ÄN H√åNH ƒêƒÇNG NH·∫¨P */
        #authScreen { position: fixed; inset: 0; background: radial-gradient(circle at center, #1e293b, #0f172a); z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .auth-box { background: var(--card); padding: 40px; border-radius: 30px; width: 380px; text-align: center; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 0 50px rgba(0,255,136,0.1); }
        .auth-box h1 { font-weight: 900; color: var(--main); font-size: 30px; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 2px; }

        /* HEADER */
        header { position: sticky; top: 0; height: 80px; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); display: flex; align-items: center; padding: 0 30px; z-index: 1000; border-bottom: 2px solid var(--main); }
        .logo { font-weight: 900; font-size: 24px; color: var(--main); flex: 1; }
        .wallet-box { background: rgba(0, 255, 136, 0.1); padding: 10px 20px; border-radius: 15px; border: 1px solid var(--main); color: var(--main); font-weight: bold; }

        /* SHOP GRID */
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .shop-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        .product-card { background: var(--card); border-radius: 25px; padding: 25px; border: 1px solid rgba(255,255,255,0.05); transition: 0.3s; position: relative; }
        .product-card:hover { transform: translateY(-8px); border-color: var(--main); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .stock-info { background: rgba(0,0,0,0.3); border-radius: 15px; padding: 12px; font-size: 11px; margin-bottom: 15px; color: #94a3b8; border-left: 3px solid var(--accent); }
        
        input, select, button, textarea { width: 100%; padding: 13px; margin: 8px 0; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); background: #0f172a; color: white; outline: none; }
        .btn-main { background: var(--main); color: #000; font-weight: 900; border: none; cursor: pointer; text-transform: uppercase; transition: 0.2s; }
        .btn-main:hover { opacity: 0.8; transform: scale(0.98); }

        /* SIDE MENU (DRAWER) */
        #sideMenu { position: fixed; top: 0; left: -450px; width: 380px; height: 100%; background: var(--card); z-index: 2000; padding: 30px; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 20px 0 50px rgba(0,0,0,0.8); overflow-y: auto; }
        #robotArea { background: #000; border-radius: 20px; padding: 20px; margin-top: 20px; border: 1px solid #333; }
        #robotLogs { height: 150px; overflow-y: auto; font-family: monospace; font-size: 10px; color: #00ff88; text-align: left; background: #050505; padding: 10px; border-radius: 10px; }

        /* MODALS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 5000; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .modal-content { background: var(--card); padding: 30px; border-radius: 30px; width: 480px; text-align: center; border: 1px solid var(--main); }
        .result-box { background: #000; padding: 15px; border-radius: 12px; color: var(--main); font-family: monospace; margin: 15px 0; white-space: pre-wrap; text-align: left; max-height: 150px; overflow-y: auto; border: 1px solid #222; }
        
        #overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 1500; }
        .hist-card { background: rgba(255,255,255,0.03); padding: 12px; border-radius: 12px; margin-bottom: 8px; text-align: left; border-left: 4px solid var(--main); }
    </style>
</head>
<body>

    <div id="globalNotify"></div>

    <div id="authScreen">
        <div class="auth-box">
            <h1>VINHMODLAG</h1>
            <div id="loginForm">
                <input type="text" id="uLog" placeholder="T√™n ƒëƒÉng nh·∫≠p...">
                <input type="password" id="pLog" placeholder="M·∫≠t kh·∫©u...">
                <button class="btn-main" onclick="handleLogin()">üöÄ ƒêƒÇNG NH·∫¨P</button>
                <p onclick="toggleAuth('reg')" style="font-size:12px; margin-top:20px; cursor:pointer; color:var(--main)">S·∫øp ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω</p>
            </div>
            <div id="regForm" style="display:none">
                <input type="text" id="uReg" placeholder="T√™n mu·ªën ƒëƒÉng k√Ω...">
                <input type="password" id="pReg" placeholder="M·∫≠t kh·∫©u b·∫£o m·∫≠t...">
                <button class="btn-main" style="background:var(--accent)" onclick="handleRegister()">‚úÖ HO√ÄN T·∫§T ƒêƒÇNG K√ù</button>
                <p onclick="toggleAuth('log')" style="font-size:12px; margin-top:20px; cursor:pointer;">ƒê√£ c√≥ t√†i kho·∫£n? Quay l·∫°i</p>
            </div>
        </div>
    </div>

    <div id="app" style="display:none">
        <header>
            <div onclick="openMenu()" style="font-size:25px; cursor:pointer; margin-right:20px; color:var(--main)">‚ò∞ MENU</div>
            <div class="logo">VINHMODLAG</div>
            <div class="wallet-box">üí∞ <span id="userBal">0</span>ƒë</div>
        </header>

        <div id="sideMenu">
            <h2 style="color:var(--main); margin-bottom: 5px;">S·∫øp: <span id="uNameDisp"></span></h2>
            <button class="btn-main" style="background:#334155; font-size:11px; margin-bottom: 10px;" onclick="openModal('modalHist')">üìä L·ªäCH S·ª¨ MUA H√ÄNG</button>
            <hr style="margin:20px 0; opacity:0.1">
            
            <p style="font-size:11px; font-weight:bold; color:var(--accent)">N·∫†P TI·ªÄN H·ªÜ TH·ªêNG</p>
            <select id="payType" onchange="switchPay(this.value)">
                <option value="bank">Ng√¢n H√†ng (QR T·ª± ƒê·ªông)</option>
                <option value="the">Th·∫ª C√†o ƒêi·ªán Tho·∫°i</option>
            </select>

            <div id="bankArea">
                <input type="number" id="payAmt" placeholder="Nh·∫≠p s·ªë ti·ªÅn...">
                <button class="btn-main" style="background:#0066ff; color:white;" onclick="createQR()">T·∫†O M√É QR</button>
                <div id="qrRes" style="display:none; margin-top:10px; text-align:center;">
                    <img id="qrImg" style="width:100%; border-radius:15px; border: 2px solid #0066ff;">
                    <p style="font-size: 10px; color: var(--main); margin-top: 5px;">Qu√©t m√£ ƒë·ªÉ n·∫°p ti·ªÅn t·ª± ƒë·ªông 24/7</p>
                </div>
            </div>

            <div id="cardArea" style="display:none">
                <select id="cardType">
                    <option value="Viettel">Viettel</option>
                    <option value="Vinaphone">Vinaphone</option>
                    <option value="Mobifone">Mobifone</option>
                    <option value="Zing">Th·∫ª Zing</option>
                </select>
                <select id="cardValue">
                    <option value="20000">20.000ƒë</option>
                    <option value="50000">50.000ƒë</option>
                    <option value="100000">100.000ƒë</option>
                    <option value="200000">200.000ƒë</option>
                    <option value="500000">500.000ƒë</option>
                </select>
                <input id="cardPin" placeholder="M√£ th·∫ª (PIN)...">
                <input id="cardSeri" placeholder="S·ªë Seri...">
                <button class="btn-main" onclick="sendCard()">G·ª¨I ADMIN DUY·ªÜT TH·∫∫</button>
            </div>

            <div id="adminPanel" style="display:none">
                <div id="robotArea">
                    <b style="color:var(--main); font-size:11px;">üñ•Ô∏è ROBOT VINHMOD ADMIN</b>
                    <div id="robotLogs">D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c Auto-Save!</div>
                    <input id="botCmd" placeholder="Nh·∫≠p l·ªánh (.help)">
                    <button onclick="execBot()" style="background:var(--main); color:black; font-size:10px; font-weight: 900;">TH·ª∞C THI</button>
                    <button onclick="openModal('modalStock')" style="background:#475569; margin-top:5px; font-size:10px;">üì¶ N·∫†P H√ÄNG V√ÄO KHO</button>
                </div>
            </div>
            
            <button onclick="logout()" style="border:1px solid #ef4444; color:#ef4444; background:none; margin-top:20px; font-size: 12px;">ƒêƒÇNG XU·∫§T T√ÄI KHO·∫¢N</button>
        </div>

        <div class="container">
            <div class="shop-grid" id="shopGrid"></div>
        </div>
    </div>

    <div id="modalSuccess" class="modal"><div class="modal-content">
        <h2 style="color:var(--main)">GIAO D·ªäCH XONG! ‚úÖ</h2>
        <div class="result-box" id="resKeys"></div>
        <button class="btn-main" onclick="copyKeys()">SAO CH√âP D·ªÆ LI·ªÜU</button>
        <button onclick="closeModal('modalSuccess')" style="background:none; border:none; color:#94a3b8; margin-top:15px; cursor:pointer;">ƒê√ìNG</button>
    </div></div>

    <div id="modalStock" class="modal"><div class="modal-content">
        <h3>üì¶ N·∫†P TH√äM H√ÄNG</h3>
        <select id="stkProd">
            <option value="clone5">Acc Clone Lv5</option>
            <option value="itachi">Itachi Ping V3</option>
            <option value="hopper">Hopper Plus</option>
        </select>
        <select id="stkPlan"><option>M·∫∑c ƒë·ªãnh</option><option>1 Ng√†y</option><option>7 Ng√†y</option><option>30 Ng√†y</option><option>Vƒ©nh Vi·ªÖn</option></select>
        <textarea id="stkRaw" rows="6" placeholder="M·ªói d√≤ng l√† 1 Key ho·∫∑c 1 Acc..."></textarea>
        <button class="btn-main" onclick="addStock()">X√ÅC NH·∫¨N N·∫†P</button>
        <button onclick="closeModal('modalStock')" style="background:none; border:none; color:#aaa; margin-top:10px;">H·ª¶Y</button>
    </div></div>

    <div id="modalHist" class="modal"><div class="modal-content">
        <h3>üìä L·ªäCH S·ª¨ GIAO D·ªäCH</h3>
        <div id="histContent" style="max-height: 300px; overflow-y: auto; margin: 15px 0;"></div>
        <button onclick="closeModal('modalHist')">QUAY L·∫†I</button>
    </div></div>

    <div id="overlay" onclick="closeMenu()"></div>

    <script>
        const KEY_DB = 'VINHMOD_V90_DB';
        const KEY_SS = 'VINHMOD_V90_SESSION';

        // DATABASE KH·ªûI T·∫†O
        let data = JSON.parse(localStorage.getItem(KEY_DB)) || {
            users: { "vinhmoddz": { p: "vinhmoddz", b: 9999999, admin: true, buys: [] } },
            prods: [
                { id: 0, slug: "clone5", name: "Acc Clone Lv5", plans: { "M·∫∑c ƒë·ªãnh": 5000 }, stock: { "M·∫∑c ƒë·ªãnh": [] } },
                { id: 1, slug: "itachi", name: "Itachi Ping V3", plans: { "1 Ng√†y": 10000, "7 Ng√†y": 50000, "30 Ng√†y": 150000, "Vƒ©nh Vi·ªÖn": 400000 }, stock: { "1 Ng√†y": [], "7 Ng√†y": [], "30 Ng√†y": [], "Vƒ©nh Vi·ªÖn": [] } },
                { id: 2, slug: "hopper", name: "Hopper Plus", plans: { "1 Ng√†y": 15000, "7 Ng√†y": 70000, "30 Ng√†y": 400000, "Vƒ©nh Vi·ªÖn": 420000 }, stock: { "1 Ng√†y": [], "7 Ng√†y": [], "30 Ng√†y": [], "Vƒ©nh Vi·ªÖn": [] } }
            ]
        };

        let user = localStorage.getItem(KEY_SS) || null;

        // C∆† CH·∫æ AUTO-SAVE T·ªîNG L·ª∞C
        function save() { 
            localStorage.setItem(KEY_DB, JSON.stringify(data)); 
            if(user) renderShop(); 
            console.log("H·ªá th·ªëng ƒë√£ t·ª± ƒë·ªông l∆∞u d·ªØ li·ªáu!");
        }
        window.onbeforeunload = save;

        function renderShop() {
            if(!user) return;
            document.getElementById('userBal').innerText = data.users[user].b.toLocaleString();
            let grid = document.getElementById('shopGrid'); grid.innerHTML = "";
            data.prods.forEach(p => {
                let sTxt = Object.keys(p.stock).map(k => `<b>${k}:</b> ${p.stock[k].length}`).join(' | ');
                grid.innerHTML += `<div class="product-card">
                    <div class="stock-info">${sTxt}</div>
                    <h2 style="color:var(--main); margin-bottom:15px;">${p.name}</h2>
                    <select id="sel-${p.id}">${Object.keys(p.plans).map(k=>`<option value="${k}">${k} - ${p.plans[k].toLocaleString()}ƒë</option>`).join('')}</select>
                    <input type="number" id="qty-${p.id}" value="1" min="1">
                    <button class="btn-main" onclick="buy(${p.id})">Mua Ngay</button>
                </div>`;
            });
        }

        function buy(id) {
            let p = data.prods[id], plan = document.getElementById(`sel-${id}`).value, qty = parseInt(document.getElementById(`qty-${id}`).value) || 0;
            let total = p.plans[plan] * qty;
            if(qty <= 0 || data.users[user].b < total || p.stock[plan].length < qty) return alert("S·∫øp ∆°i, kh√¥ng ƒë·ªß ti·ªÅn ho·∫∑c kho ƒë√£ h·∫øt h√†ng!");
            
            let out = []; for(let i=0; i<qty; i++) out.push(p.stock[plan].shift());
            data.users[user].b -= total;
            data.users[user].buys.unshift({ name: p.name, plan, qty, keys: out, t: new Date().toLocaleString() });
            save();
            document.getElementById('resKeys').innerText = out.join("\n"); 
            openModal('modalSuccess');
        }

        // ROBOT ADMIN: ƒêI·ªÄU KHI·ªÇN ƒê·∫æ CH·∫æ
        function execBot() {
            let cmd = document.getElementById('botCmd').value.trim(), p = cmd.split(" "), logs = document.getElementById('robotLogs');
            let res = "";

            if(p[0] === ".duyet") { // N·∫°p ti·ªÅn: .duyet [t√™n] [ti·ªÅn] duyet
                if(data.users[p[1]]) { data.users[p[1]].b += parseInt(p[2]); res = `\n‚úÖ +${p[2]}ƒë cho ${p[1]}`; }
            } else if(p[0] === ".tru") { // Tr·ª´ ti·ªÅn: .tru [t√™n] [ti·ªÅn] tru
                if(data.users[p[1]]) { data.users[p[1]].b -= parseInt(p[2]); res = `\n‚ö†Ô∏è -${p[2]}ƒë c·ªßa ${p[1]}`; }
            } else if(p[0] === ".pass") { // ƒê·ªïi pass: .pass [t√™n] [m·∫≠t_kh·∫©u_m·ªõi]
                if(data.users[p[1]]) { data.users[p[1]].p = p[2]; res = `\nüîë Pass m·ªõi ${p[1]}: ${p[2]}`; }
            } else if(p[0] === ".clear" && p[1] === "kho") { // Reset kho
                data.prods.forEach(pr => Object.keys(pr.stock).forEach(k => pr.stock[k] = []));
                res = `\nüóëÔ∏è ƒê√£ x√≥a s·∫°ch kho h√†ng!`;
            } else if(p[0] === ".thongbao") { // G·ª≠i tin nh·∫Øn popup
                let msg = p.slice(1).join(" ");
                let popup = document.getElementById('globalNotify');
                popup.innerText = "üì£ VINHMOD: " + msg; popup.style.display = 'block';
                setTimeout(()=> popup.style.display = 'none', 6000);
                res = `\nüì¢ ƒê√£ ph√°t th√¥ng b√°o to√†n shop!`;
            } else if(p[0] === ".banggiaudich") { // Check t·ªìn kho
                res = "\n--- TH·ªêNG K√ä KHO ---";
                data.prods.forEach(pr => Object.keys(pr.stock).forEach(k => { if(pr.stock[k].length > 0) res += `\n${pr.name} (${k}): ${pr.stock[k].length}`; }));
            } else if(p[0] === ".help") {
                res = "\nL·ªÜNH: .duyet, .tru, .pass, .clear kho, .thongbao, .banggiaudich";
            } else { res = "\n‚ùå Sai l·ªánh s·∫øp ∆°i! G√µ .help"; }

            logs.innerHTML += res; logs.scrollTop = logs.scrollHeight; 
            document.getElementById('botCmd').value = ""; 
            save();
        }

        // AUTH FUNCTIONS
        function handleLogin() {
            let u = document.getElementById('uLog').value, p = document.getElementById('pLog').value;
            if(data.users[u] && data.users[u].p === p) { user = u; localStorage.setItem(KEY_SS, u); init(); } else alert("Th√¥ng tin ƒëƒÉng nh·∫≠p kh√¥ng ƒë√∫ng!");
        }
        function handleRegister() {
            let u = document.getElementById('uReg').value, p = document.getElementById('pReg').value;
            if(u && !data.users[u]) { data.users[u] = {p, b:0, admin:false, buys:[]}; save(); toggleAuth('log'); alert("ƒêƒÉng k√Ω th√†nh c√¥ng!"); } else alert("T√™n ƒë√£ t·ªìn t·∫°i!");
        }
        function init() {
            document.getElementById('authScreen').style.display='none'; 
            document.getElementById('app').style.display='block';
            document.getElementById('uNameDisp').innerText = user;
            document.getElementById('adminPanel').style.display = data.users[user].admin ? 'block' : 'none';
            renderShop();
        }
        function toggleAuth(m) { document.getElementById('loginForm').style.display = m==='log'?'block':'none'; document.getElementById('regForm').style.display = m==='reg'?'block':'none'; }
        
        // UTILS
        function addStock() {
            let pr = data.prods.find(x => x.slug === document.getElementById('stkProd').value);
            let raw = document.getElementById('stkRaw').value.trim();
            if(raw) { pr.stock[document.getElementById('stkPlan').value].push(...raw.split('\n')); save(); closeModal('modalStock'); alert("ƒê√£ th√™m h√†ng!"); document.getElementById('stkRaw').value=""; }
        }
        function openMenu() { document.getElementById('sideMenu').style.left = '0'; document.getElementById('overlay').style.display = 'block'; }
        function closeMenu() { document.getElementById('sideMenu').style.left = '-450px'; document.getElementById('overlay').style.display = 'none'; }
        function openModal(id) { 
            document.getElementById(id).style.display = 'flex'; 
            if(id === 'modalHist') {
                let h = document.getElementById('histContent'); h.innerHTML = "";
                data.users[user].buys.forEach(b => h.innerHTML += `<div class="hist-card"><b>${b.name} (x${b.qty})</b><br><small style="color:#94a3b8">${b.t}</small><br><code style="color:var(--main)">${b.keys.join(", ")}</code></div>`);
            }
        }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function copyKeys() { navigator.clipboard.writeText(document.getElementById('resKeys').innerText); alert("ƒê√£ sao ch√©p v√†o b·ªô nh·ªõ!"); }
        function createQR() { let a = document.getElementById('payAmt').value; document.getElementById('qrImg').src = `https://img.vietqr.io/image/MB-0364684151-compact2.jpg?amount=${a}&addInfo=NAP ${user}`; document.getElementById('qrRes').style.display='block'; }
        function switchPay(v) { document.getElementById('bankArea').style.display = v==='bank'?'block':'none'; document.getElementById('cardArea').style.display = v==='the'?'block':'none'; }
        function sendCard() { alert("Th√¥ng tin th·∫ª ƒë√£ g·ª≠i ƒë·∫øn Admin Vinh! Vui l√≤ng ch·ªù duy·ªát."); }
        function logout() { localStorage.removeItem(KEY_SS); location.reload(); }
        
        if(user) init();
    </script>
</body>
              </html>
                      
